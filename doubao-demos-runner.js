const https = require('https');
const fs = require('fs');

// è¯»å–é£žä¹¦é…ç½®
const feishuConfig = JSON.parse(fs.readFileSync('.feishu.config.json', 'utf8'));

// è±†åŒ…Demoåˆ›æ„è¡¨é…ç½®
const DOUBAO_TABLE_ID = 'tblyEaRH1YpwAPxQ';

console.log('æ­£åœ¨ç”Ÿæˆè±†åŒ…Demoæ¡ˆä¾‹...\n');

// Tokenç®¡ç†å™¨
class TokenManager {
    constructor() {
        this.token = null;
        this.tokenExpireTime = 0;
    }

    async getToken() {
        const now = Date.now();
        if (!this.token || now >= this.tokenExpireTime - 5 * 60 * 1000) {
            await this.refreshToken();
        }
        return this.token;
    }

    async refreshToken() {
        console.log('  [Token] åˆ·æ–°é£žä¹¦Token...');
        this.token = await this._fetchNewToken();
        this.tokenExpireTime = Date.now() + 2 * 60 * 60 * 1000;
    }

    async _fetchNewToken() {
        return new Promise((resolve, reject) => {
            const data = JSON.stringify({
                app_id: feishuConfig.app_id,
                app_secret: feishuConfig.app_secret
            });
            const req = https.request({
                hostname: 'open.feishu.cn',
                path: '/open-apis/auth/v3/tenant_access_token/internal',
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Content-Length': Buffer.byteLength(data) }
            }, res => {
                let body = '';
                res.on('data', chunk => body += chunk);
                res.on('end', () => {
                    const result = JSON.parse(body);
                    result.code === 0 ? resolve(result.tenant_access_token) : reject(new Error(result.msg));
                });
            });
            req.on('error', reject);
            req.write(data);
            req.end();
        });
    }
}

const tokenManager = new TokenManager();

// 18ä¸ªè±†åŒ…Demoæ•°æ®
const doubaoData = {
    abilities: [
        {
            id: "agent",
            name: "æ›´å¼ºAgentèƒ½åŠ›",
            icon: "ðŸ’¡",
            color: "#6366f1",
            tags: ["å·¥å…·è°ƒç”¨", "å¤æ‚æŒ‡ä»¤éµå¾ª", "OS Agentèƒ½åŠ›", "GUI Agent", "BrowserCompå…¨çƒé¢†å…ˆ"],
            demos: [
                {
                    name: "å…¨ç½‘æ¯”ä»·+ä¸€é”®ä¸‹å•",
                    subtitle: "å±•ç¤ºGUI Agentèƒ½åŠ› + åä½™å·¥å…·ä¸²è”è°ƒç”¨",
                    scene: "ç”¨æˆ·æƒ³ä¹°iPhone16ä½†ä¸çŸ¥é“å“ªä¸ªå¹³å°æœ€ä¾¿å®œï¼Œéœ€è¦é€ä¸ªæ‰“å¼€ç½‘ç«™æ¯”ä»·å¾ˆéº»çƒ¦ã€‚è±†åŒ…Agentè‡ªåŠ¨è®¿é—®è‹¹æžœå®˜ç½‘ã€äº¬ä¸œã€æ·˜å®ã€æ‹¼å¤šå¤šï¼Œæå–ä»·æ ¼åŽå¯¹æ¯”å±•ç¤ºã€‚",
                    steps: ["â‘  ç”¨æˆ·è¯´ã€Œå¯¹æ¯”å„å¹³å°iPhone16 Proçš„ä»·æ ¼ã€", "â‘¡ Agentè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨è®¿é—®4ä¸ªè´­ç‰©ç½‘ç«™", "â‘¢ æ™ºèƒ½è¯†åˆ«é¡µé¢ä»·æ ¼ä¿¡æ¯å¹¶æˆªå›¾", "â‘£ ç”Ÿæˆä»·æ ¼å¯¹æ¯”è¡¨æ ¼å¹¶æŽ¨èæœ€ä¼˜æ¸ é“"],
                    coreDisplay: "æ— éœ€APIï¼Œç›´æŽ¥æ“ä½œGUIç•Œé¢å®Œæˆå¤æ‚å¤šæ­¥éª¤ä»»åŠ¡",
                    expectedEffect: "ç”¨æˆ·çœ‹åˆ°å®Œæ•´çš„æ¯”ä»·è¿‡ç¨‹å’Œç»“æžœï¼Œä½“éªŒã€ŒAIæ›¿ä½ å¹²æ´»ã€çš„éœ‡æ’¼"
                },
                {
                    name: "ä¼ä¸šERPæ— APIè‡ªåŠ¨åŒ–",
                    subtitle: "å±•ç¤ºè€æ—§ç³»ç»Ÿè‡ªåŠ¨åŒ–èƒ½åŠ›",
                    scene: "å…¬å¸è´¢åŠ¡æ¯å¤©è¦ç™»å½•è€æ—§ERPç³»ç»Ÿå¯¼å‡ºæŠ¥è¡¨ï¼Œç³»ç»Ÿæ²¡æœ‰APIåªèƒ½æ‰‹åŠ¨æ“ä½œã€‚è±†åŒ…Agentåƒäººä¸€æ ·æ“ä½œç•Œé¢å®Œæˆä»»åŠ¡ã€‚",
                    steps: ["â‘  è‡ªåŠ¨æ‰“å¼€ERPç³»ç»Ÿç™»å½•é¡µé¢", "â‘¡ æ¨¡æ‹Ÿäººå·¥è¾“å…¥è´¦å·å¯†ç å¹¶ç™»å½•", "â‘¢ å¯¼èˆªåˆ°æŠ¥è¡¨æ¨¡å—ï¼Œé€‰æ‹©æ—¥æœŸèŒƒå›´", "â‘£ ç‚¹å‡»å¯¼å‡ºæŒ‰é’®ä¸‹è½½Excelæ–‡ä»¶"],
                    coreDisplay: "è§£å†³ä¼ ç»ŸRPAæ— æ³•å¤„ç†çš„è€æ—§ç³»ç»Ÿè‡ªåŠ¨åŒ–éš¾é¢˜",
                    expectedEffect: "æ¼”ç¤ºå®Œæ•´çš„ERPæ“ä½œæµç¨‹ï¼Œçªå‡ºã€Œæ— éœ€APIã€çš„æ ¸å¿ƒä¼˜åŠ¿"
                },
                {
                    name: "è‡ªåŠ¨å†™å…¬ä¼—å·å¹¶å‘å¸ƒ",
                    subtitle: "å±•ç¤ºå†…å®¹åˆ›ä½œ+è·¨å¹³å°å‘å¸ƒèƒ½åŠ›",
                    scene: "è‡ªåª’ä½“è¿è¥è€…éœ€è¦æ¯å¤©å‘å¸ƒå†…å®¹ï¼Œä»Žé€‰é¢˜ã€å†™ä½œã€é…å›¾åˆ°å‘å¸ƒæµç¨‹ç¹çã€‚è±†åŒ…Agentå…¨æµç¨‹è‡ªåŠ¨åŒ–å®Œæˆã€‚",
                    steps: ["â‘  ç”¨æˆ·ç»™å‡ºä¸»é¢˜ã€ŒAIå‘å±•è¶‹åŠ¿ã€", "â‘¡ Agentæœç´¢æœ€æ–°èµ„æ–™å¹¶ç”Ÿæˆæ–‡ç« ", "â‘¢ è‡ªåŠ¨é…å›¾å¹¶è°ƒæ•´æŽ’ç‰ˆ", "â‘£ ç™»å½•å…¬ä¼—å·åŽå°ä¸€é”®å‘å¸ƒ"],
                    coreDisplay: "ä»Žåˆ›ä½œåˆ°å‘å¸ƒçš„å®Œæ•´å·¥ä½œæµè‡ªåŠ¨åŒ–",
                    expectedEffect: "å±•ç¤ºä¸€å¥è¯ä»Žæƒ³æ³•åˆ°å‘å¸ƒçš„å…¨æµç¨‹ï¼Œè®©ç”¨æˆ·æƒŠå¹æ•ˆçŽ‡æå‡"
                },
                {
                    name: "äº‘æ‰‹æœºè‡ªåŠ¨è®¢ç¥¨",
                    subtitle: "å±•ç¤ºç§»åŠ¨ç«¯Agentèƒ½åŠ›",
                    scene: "æ˜¥è¿æŠ¢ç¥¨éš¾ï¼Œç”¨æˆ·éœ€è¦åå¤åˆ·æ–°å¤šä¸ªAPPã€‚è±†åŒ…é€šè¿‡äº‘æ‰‹æœºè‡ªåŠ¨æ“ä½œ12306APPå®ŒæˆæŠ¢ç¥¨ã€‚",
                    steps: ["â‘  æ‰“å¼€äº‘æ‰‹æœºä¸­çš„12306APP", "â‘¡ è‡ªåŠ¨å¡«å†™å‡ºå‘åœ°ã€ç›®çš„åœ°ã€æ—¥æœŸ", "â‘¢ æŒç»­åˆ·æ–°ä½™ç¥¨å¹¶æ™ºèƒ½æŠ¢åº§", "â‘£ è‡ªåŠ¨å¡«å†™ä¹˜å®¢ä¿¡æ¯å¹¶å®Œæˆæ”¯ä»˜"],
                    coreDisplay: "çªç ´ç§»åŠ¨ç«¯è‡ªåŠ¨åŒ–çš„æŠ€æœ¯è¾¹ç•Œ",
                    expectedEffect: "çœŸå®žæ¼”ç¤ºæ‰‹æœºç«¯æ“ä½œï¼Œå±•ç¤ºã€Œäº‘æ‰‹æœº+Agentã€çš„åˆ›æ–°ç»„åˆ"
                },
                {
                    name: "æ‰¹é‡æŠ•é€’ç®€åŽ†",
                    subtitle: "å±•ç¤ºè¡¨å•è‡ªåŠ¨å¡«å†™èƒ½åŠ›",
                    scene: "æ±‚èŒè€…éœ€è¦åœ¨å¤šä¸ªæ‹›è˜å¹³å°æŠ•é€’ç®€åŽ†ï¼Œé‡å¤å¡«å†™ç›¸åŒä¿¡æ¯è€—æ—¶è€—åŠ›ã€‚Agentæ‰¹é‡å®ŒæˆæŠ•é€’ã€‚",
                    steps: ["â‘  è¯»å–ç”¨æˆ·ç®€åŽ†ä¿¡æ¯", "â‘¡ è‡ªåŠ¨æ‰“å¼€Bossç›´è˜/çŒŽè˜ç­‰ç½‘ç«™", "â‘¢ ç­›é€‰åŒ¹é…èŒä½å¹¶ç‚¹å‡»æŠ•é€’", "â‘£ è‡ªåŠ¨å¡«å†™ç”³è¯·è¡¨å•å¹¶æäº¤"],
                    coreDisplay: "å¤æ‚è¡¨å•çš„æ™ºèƒ½è¯†åˆ«ä¸Žè‡ªåŠ¨å¡«å†™",
                    expectedEffect: "5åˆ†é’Ÿå®ŒæˆåŽŸæœ¬éœ€è¦2å°æ—¶çš„ç®€åŽ†æŠ•é€’å·¥ä½œ"
                },
                {
                    name: "è·¨ç³»ç»Ÿæ•°æ®æ¬è¿å·¥",
                    subtitle: "å±•ç¤ºå¤šç³»ç»Ÿä¸²è”èƒ½åŠ›",
                    scene: "ä¼ä¸šæ•°æ®åˆ†æ•£åœ¨å¤šä¸ªç³»ç»Ÿï¼Œäººå·¥æ¬è¿æ•°æ®å®¹æ˜“å‡ºé”™ã€‚Agentè‡ªåŠ¨åœ¨ç³»ç»Ÿé—´åŒæ­¥æ•°æ®ã€‚",
                    steps: ["â‘  ç™»å½•CRMç³»ç»Ÿå¯¼å‡ºå®¢æˆ·æ•°æ®", "â‘¡ ç™»å½•ERPç³»ç»Ÿå¯¼å…¥è®¢å•ä¿¡æ¯", "â‘¢ æ•°æ®æ ¡éªŒå¹¶è‡ªåŠ¨çº é”™", "â‘£ ç”ŸæˆåŒæ­¥æ—¥å¿—æŠ¥å‘Š"],
                    coreDisplay: "æ‰“é€šä¼ä¸šã€Œæ•°æ®å­¤å²›ã€çš„å…¨è‡ªåŠ¨åŒ–æ–¹æ¡ˆ",
                    expectedEffect: "å±•ç¤ºä¸‰ä¸ªä»¥ä¸Šç³»ç»Ÿçš„æ•°æ®æµè½¬ï¼Œçªå‡ºAgentçš„é€šç”¨æ€§"
                }
            ]
        },
        {
            id: "multimodal",
            name: "æ›´å¼ºå¤šæ¨¡æ€èƒ½åŠ›",
            icon: "ðŸ‘ï¸",
            color: "#06b6d4",
            tags: ["è§†è§‰æŽ¨ç†", "è§†é¢‘ç†è§£", "1280å¸§", "ZeroBenchå…¨çƒé¢†å…ˆ"],
            demos: [
                {
                    name: "æ‹ç…§è§£é¢˜å…¨ç§‘é€š",
                    subtitle: "å±•ç¤ºå¤æ‚å›¾å½¢è¯†åˆ«+æŽ¨ç†èƒ½åŠ›",
                    scene: "å­¦ç”Ÿé‡åˆ°å‡ ä½•ã€ç‰©ç†ç­‰åŒ…å«å›¾å½¢çš„é¢˜ç›®ï¼Œæ‹ç…§å°±èƒ½èŽ·å¾—è¯¦ç»†è§£ç­”å’ŒåŒç±»é¢˜æŽ¨èã€‚",
                    steps: ["â‘  æ‹æ‘„åŒ…å«å›¾å½¢çš„æ•°å­¦é¢˜", "â‘¡ AIè¯†åˆ«æ–‡å­—å’Œå‡ ä½•å›¾å½¢", "â‘¢ åˆ†æ­¥éª¤è§£æžæŽ¨ç†è¿‡ç¨‹", "â‘£ ç”Ÿæˆ3é“åŒç±»ç»ƒä¹ é¢˜"],
                    coreDisplay: "å¤æ‚å›¾å½¢çš„ç²¾å‡†è¯†åˆ«ä¸Žæ•°å­¦æŽ¨ç†èƒ½åŠ›",
                    expectedEffect: "å±•ç¤ºå‡ ä½•è¯æ˜Žé¢˜çš„å®Œæ•´è§£ç­”è¿‡ç¨‹ï¼Œçªå‡ºè§†è§‰æŽ¨ç†ä¼˜åŠ¿"
                },
                {
                    name: "ä½œæ–‡æ™ºèƒ½æ‰¹æ”¹å®˜",
                    subtitle: "å±•ç¤ºæ‰‹å†™è¯†åˆ«+è¯­è¨€ç†è§£èƒ½åŠ›",
                    scene: "è€å¸ˆæ‰¹æ”¹ä½œæ–‡è€—æ—¶è´¹åŠ›ï¼Œè±†åŒ…é€šè¿‡ç…§ç‰‡è¯†åˆ«æ‰‹å†™å†…å®¹å¹¶ç»™å‡ºä¸“ä¸šç‚¹è¯„ã€‚",
                    steps: ["â‘  æ‹æ‘„å­¦ç”Ÿæ‰‹å†™ä½œæ–‡", "â‘¡ è¯†åˆ«æ‰‹å†™å†…å®¹è½¬æ¢ä¸ºæ–‡æœ¬", "â‘¢ ä»Žç«‹æ„ã€ç»“æž„ã€è¯­è¨€å¤šç»´åº¦ç‚¹è¯„", "â‘£ ç»™å‡ºè¯„åˆ†å’Œä¼˜åŒ–å»ºè®®"],
                    coreDisplay: "æ‰‹å†™ä½“OCR + æ·±åº¦è¯­è¨€ç†è§£çš„ç»“åˆ",
                    expectedEffect: "å±•ç¤ºå®Œæ•´çš„æ‰¹æ”¹æŠ¥å‘Šï¼ŒåŒ…å«æ‰¹æ³¨å’Œä¿®æ”¹å»ºè®®"
                },
                {
                    name: "1å°æ—¶è§†é¢‘é€Ÿè§ˆ",
                    subtitle: "å±•ç¤º1280å¸§è¶…é•¿è§†é¢‘ç†è§£",
                    scene: "ç”¨æˆ·æ²¡æ—¶é—´çœ‹å®Œ1å°æ—¶çš„ä¼šè®®å½•åƒæˆ–ç½‘è¯¾ï¼Œéœ€è¦å¿«é€Ÿäº†è§£æ ¸å¿ƒå†…å®¹ã€‚",
                    steps: ["â‘  ä¸Šä¼ 1å°æ—¶ä¼šè®®/è¯¾ç¨‹è§†é¢‘", "â‘¡ ä½Žå¸§çŽ‡æ‰«æå…¨ç‰‡å®šä½å…³é”®ç‰‡æ®µ", "â‘¢ é«˜å¸§çŽ‡èšç„¦é‡ç‚¹å†…å®¹æ·±åº¦ç†è§£", "â‘£ ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„ç»“æž„åŒ–æ‘˜è¦"],
                    coreDisplay: "1280å¸§é•¿è§†é¢‘ç†è§£ï¼Œä¸šç•Œé¢†å…ˆ",
                    expectedEffect: "å±•ç¤º1å°æ—¶è§†é¢‘5åˆ†é’Ÿå‡ºæ‘˜è¦çš„æ•ˆçŽ‡"
                },
                {
                    name: "ç”Ÿäº§çº¿è´¨æ£€AI",
                    subtitle: "å±•ç¤ºå®žæ—¶è§†é¢‘åˆ†æžèƒ½åŠ›",
                    scene: "å·¥åŽ‚äº§å“è´¨æ£€ä¾èµ–äººå·¥ï¼Œå®¹æ˜“ç–²åŠ³æ¼æ£€ã€‚AIå®žæ—¶åˆ†æžç”Ÿäº§çº¿è§†é¢‘è¯†åˆ«ç¼ºé™·ã€‚",
                    steps: ["â‘  æŽ¥å…¥ç”Ÿäº§çº¿æ‘„åƒå¤´å®žæ—¶ç”»é¢", "â‘¡ æ¯ç§’å¤šå¸§åˆ†æžäº§å“å¤–è§‚", "â‘¢ æ£€æµ‹åˆ°ç¼ºé™·ç«‹å³æ ‡è®°å‘Šè­¦", "â‘£ ç”Ÿæˆè´¨æ£€æ—¥æŠ¥ç»Ÿè®¡åˆæ ¼çŽ‡"],
                    coreDisplay: "å®žæ—¶è§†é¢‘æµçš„é«˜ç²¾åº¦ç¼ºé™·æ£€æµ‹",
                    expectedEffect: "æ¼”ç¤ºç¼ºé™·æ£€å‡ºçš„çž¬é—´å“åº”å’Œç²¾å‡†å®šä½"
                },
                {
                    name: "å®‰é˜²ç›‘æŽ§æ™ºèƒ½çœ¼",
                    subtitle: "å±•ç¤ºå¼‚å¸¸è¡Œä¸ºè¯†åˆ«èƒ½åŠ›",
                    scene: "å®‰ä¿äººå‘˜éš¾ä»¥24å°æ—¶ç›¯ç€ç›‘æŽ§ï¼ŒAIè‡ªåŠ¨è¯†åˆ«å¼‚å¸¸è¡Œä¸ºå¹¶é¢„è­¦ã€‚",
                    steps: ["â‘  æŽ¥å…¥å®‰é˜²æ‘„åƒå¤´è§†é¢‘æµ", "â‘¡ å®žæ—¶åˆ†æžäººå‘˜è¡Œä¸ºæ¨¡å¼", "â‘¢ æ£€æµ‹é—¯å…¥/æ‰“æž¶/è·Œå€’ç­‰å¼‚å¸¸", "â‘£ ç«‹å³æŽ¨é€å‘Šè­¦åˆ°æ‰‹æœº"],
                    coreDisplay: "å¤æ‚åœºæ™¯ä¸‹çš„å¼‚å¸¸è¡Œä¸ºè¯†åˆ«",
                    expectedEffect: "æ¼”ç¤ºå¼‚å¸¸è¡Œä¸ºæ£€å‡ºåˆ°å‘Šè­¦çš„å®Œæ•´æµç¨‹"
                },
                {
                    name: "è¯¾ç¨‹è§†é¢‘æ‰¾ç­”æ¡ˆ",
                    subtitle: "å±•ç¤ºè§†é¢‘å†…å®¹ç²¾å‡†å®šä½",
                    scene: "å­¦ç”Ÿçœ‹å®Œç½‘è¯¾å¿˜è®°æŸä¸ªçŸ¥è¯†ç‚¹åœ¨å“ªï¼Œéœ€è¦å¿«é€Ÿå®šä½åˆ°å…·ä½“æ—¶é—´ç‚¹å¤ä¹ ã€‚",
                    steps: ["â‘  ä¸Šä¼ 20åˆ†é’Ÿè¯¾ç¨‹è§†é¢‘", "â‘¡ ç”¨æˆ·æé—®ã€Œå¯¼æ•°çš„å®šä¹‰åœ¨å“ªè®²çš„ã€", "â‘¢ AIåˆ†æžè§†é¢‘å†…å®¹å®šä½æ—¶é—´ç‚¹", "â‘£ è·³è½¬åˆ°15:32å¹¶é«˜äº®å±•ç¤º"],
                    coreDisplay: "è§†é¢‘å†…å®¹çš„è¯­ä¹‰ç†è§£ä¸Žç²¾å‡†æ£€ç´¢",
                    expectedEffect: "å±•ç¤ºé—®ç­”å¼è§†é¢‘æ£€ç´¢çš„ä¾¿æ·æ€§"
                }
            ]
        },
        {
            id: "llm",
            name: "æ›´å¼ºLLMèƒ½åŠ›",
            icon: "ðŸ§ ",
            color: "#f59e0b",
            tags: ["æŽ¨ç†ä¸Žæ•°å­¦", "256Kè¶…é•¿ä¸Šä¸‹æ–‡", "Tokenæ•ˆçŽ‡é¢†å…ˆ"],
            demos: [
                {
                    name: "200é¡µåˆåŒé€Ÿè¯»",
                    subtitle: "å±•ç¤º256Kè¶…é•¿ä¸Šä¸‹æ–‡èƒ½åŠ›",
                    scene: "å¾‹å¸ˆ/å•†åŠ¡äººå‘˜éœ€è¦å®¡é˜…è¶…é•¿åˆåŒï¼Œé€é¡µé˜…è¯»æ•ˆçŽ‡å¤ªä½Žä¸”å®¹æ˜“é—æ¼å…³é”®æ¡æ¬¾ã€‚",
                    steps: ["â‘  ä¸Šä¼ 200é¡µPDFåˆåŒæ–‡ä»¶", "â‘¡ AIä¸€æ¬¡æ€§è¯»å–å…¨éƒ¨å†…å®¹", "â‘¢ æå–å…³é”®æ¡æ¬¾å’Œé£Žé™©ç‚¹", "â‘£ ç”ŸæˆåˆåŒå®¡é˜…æŠ¥å‘Š"],
                    coreDisplay: "256Kä¸Šä¸‹æ–‡ä¸€æ¬¡æ€§å¤„ç†è¶…é•¿æ–‡æ¡£",
                    expectedEffect: "10åˆ†é’Ÿå®ŒæˆåŽŸæœ¬éœ€è¦2å¤©çš„åˆåŒå®¡é˜…"
                },
                {
                    name: "è´¢æŠ¥æ™ºèƒ½åˆ†æžå¸ˆ",
                    subtitle: "å±•ç¤ºé‡‘èžé¢†åŸŸç²¾å‡†æŽ¨ç†",
                    scene: "æŠ•èµ„è€…éœ€è¦åˆ†æžå…¬å¸è´¢æŠ¥ï¼Œä½†çœ‹ä¸æ‡‚å¤æ‚çš„è´¢åŠ¡æ•°æ®å’ŒæŒ‡æ ‡å…³ç³»ã€‚",
                    steps: ["â‘  ä¸Šä¼ å…¬å¸å¹´åº¦è´¢æŠ¥PDF", "â‘¡ AIæå–å…³é”®è´¢åŠ¡æŒ‡æ ‡", "â‘¢ è®¡ç®—åŒæ¯”/çŽ¯æ¯”å¢žé•¿çŽ‡", "â‘£ ç»™å‡ºæŠ•èµ„é£Žé™©æç¤ºå’Œå»ºè®®"],
                    coreDisplay: "é‡‘èžé¢†åŸŸå‡†ç¡®çŽ‡86%çš„ä¸“ä¸šåˆ†æžèƒ½åŠ›",
                    expectedEffect: "å±•ç¤ºä¸“ä¸šçº§çš„è´¢åŠ¡åˆ†æžæŠ¥å‘Š"
                },
                {
                    name: "å¤æ‚æ•°å­¦æŽ¨å¯¼",
                    subtitle: "å±•ç¤ºæ•°å­¦æŽ¨ç†èƒ½åŠ›æå‡",
                    scene: "å­¦ç”Ÿé‡åˆ°å¤æ‚çš„æ•°å­¦è¯æ˜Žé¢˜ï¼Œéœ€è¦ä¸¥è°¨çš„æŽ¨ç†è¿‡ç¨‹å’Œè§£é¢˜æ€è·¯ã€‚",
                    steps: ["â‘  è¾“å…¥æ•°å­¦è¯æ˜Žé¢˜ç›®", "â‘¡ AIåˆ†æžé¢˜ç›®æ¡ä»¶å’Œç›®æ ‡", "â‘¢ é€æ­¥å±•ç¤ºæŽ¨å¯¼è¿‡ç¨‹", "â‘£ æ€»ç»“è§£é¢˜æ–¹æ³•è®º"],
                    coreDisplay: "æ•°å­¦æŽ¨ç†èƒ½åŠ›ä»Ž65.7%æå‡è‡³74.4%",
                    expectedEffect: "å±•ç¤ºå®Œæ•´çš„æ•°å­¦è¯æ˜ŽæŽ¨å¯¼è¿‡ç¨‹"
                },
                {
                    name: "è¶…é•¿å¯¹è¯ä¸æ–­æ¡£",
                    subtitle: "å±•ç¤ºå¤šè½®å¯¹è¯çš„ä¸Šä¸‹æ–‡ç®¡ç†",
                    scene: "ç”¨æˆ·ä¸ŽAIè¿›è¡Œå¤æ‚é¡¹ç›®è®¨è®ºï¼Œå¯¹è¯è¶Šæ¥è¶Šé•¿æ‹…å¿ƒAIå¿˜è®°å‰é¢çš„å†…å®¹ã€‚",
                    steps: ["â‘  è¿›è¡Œ100+è½®çš„é¡¹ç›®è®¨è®º", "â‘¡ AIæ™ºèƒ½ç®¡ç†åŽ†å²ä¸Šä¸‹æ–‡", "â‘¢ å‡†ç¡®å¼•ç”¨ä¹‹å‰çš„è®¨è®ºå†…å®¹", "â‘£ ä¿æŒå¯¹è¯è¿žè´¯ä¸ã€Œæ–­æ¡£ã€"],
                    coreDisplay: "è¶…é•¿å¯¹è¯çš„æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†èƒ½åŠ›",
                    expectedEffect: "å±•ç¤ºå¤æ‚å¯¹è¯ä¸­çš„ä¸Šä¸‹æ–‡è®°å¿†èƒ½åŠ›"
                },
                {
                    name: "ä¼ä¸šçŸ¥è¯†åº“é—®ç­”",
                    subtitle: "å±•ç¤ºçŸ¥è¯†æ£€ç´¢+æŽ¨ç†èƒ½åŠ›",
                    scene: "ä¼ä¸šå†…éƒ¨æ–‡æ¡£åˆ†æ•£ï¼Œå‘˜å·¥æ‰¾èµ„æ–™è€—æ—¶ã€‚AIç†è§£çŸ¥è¯†åº“å¹¶ç²¾å‡†å›žç­”é—®é¢˜ã€‚",
                    steps: ["â‘  å¯¼å…¥ä¼ä¸šå†…éƒ¨çŸ¥è¯†åº“", "â‘¡ ç”¨æˆ·æé—®ä¸šåŠ¡ç›¸å…³é—®é¢˜", "â‘¢ AIæ£€ç´¢ç›¸å…³æ–‡æ¡£å†…å®¹", "â‘£ ç»“åˆå¤šä¸ªæ¥æºç»™å‡ºå‡†ç¡®ç­”æ¡ˆ"],
                    coreDisplay: "çŸ¥è¯†æ£€ç´¢ä¸Žå¤šæ­¥æŽ¨ç†çš„ç»“åˆ",
                    expectedEffect: "å±•ç¤ºä»Žæé—®åˆ°ç²¾å‡†å›žç­”çš„å®Œæ•´æµç¨‹"
                },
                {
                    name: "å¤§åž‹ä»£ç åº“ç†è§£",
                    subtitle: "å±•ç¤ºä»£ç ç†è§£ä¸Žç”Ÿæˆèƒ½åŠ›",
                    scene: "ç¨‹åºå‘˜æŽ¥æ‰‹å¤§åž‹é¡¹ç›®ï¼Œéœ€è¦å¿«é€Ÿç†è§£ä»£ç æž¶æž„å’Œä¸šåŠ¡é€»è¾‘ã€‚",
                    steps: ["â‘  å¯¼å…¥10ä¸‡è¡Œä»£ç é¡¹ç›®", "â‘¡ AIåˆ†æžé¡¹ç›®æ•´ä½“æž¶æž„", "â‘¢ å›žç­”ã€Œç™»å½•æµç¨‹æ€Žä¹ˆå®žçŽ°çš„ã€", "â‘£ å®šä½åˆ°å…·ä½“ä»£ç å¹¶è§£é‡Šé€»è¾‘"],
                    coreDisplay: "è¶…é•¿ä¸Šä¸‹æ–‡æ”¯æ’‘å¤§åž‹ä»£ç åº“åˆ†æž",
                    expectedEffect: "å±•ç¤ºä»£ç å¯¼èˆªå’Œé€»è¾‘è§£é‡Šèƒ½åŠ›"
                }
            ]
        }
    ]
};

// ç”ŸæˆJSONæ–‡ä»¶
const jsonPath = 'gemini3-doubao18.json';
fs.writeFileSync(jsonPath, JSON.stringify(doubaoData, null, 2), 'utf8');
console.log(`âœ“ JSONæ–‡ä»¶å·²ç”Ÿæˆ: ${jsonPath}`);

// å†™å…¥é£žä¹¦
async function writeToFeishu() {
    const token = await tokenManager.getToken();
    console.log('\næ­£åœ¨å†™å…¥é£žä¹¦å¤šç»´è¡¨æ ¼...');

    let successCount = 0;
    let failCount = 0;
    const failedRecords = [];

    let demoIndex = 0;
    const totalDemos = doubaoData.abilities.reduce((sum, a) => sum + a.demos.length, 0);

    for (const ability of doubaoData.abilities) {
        for (const demo of ability.demos) {
            demoIndex++;
            const record = {
                fields: {
                    "Demoåç§°": demo.name,
                    "å‰¯æ ‡é¢˜": demo.subtitle,
                    "ä½¿ç”¨åœºæ™¯": demo.scene,
                    "æ“ä½œæ­¥éª¤": Array.isArray(demo.steps) ? demo.steps.join('\n') : demo.steps,
                    "æ ¸å¿ƒå±•ç¤º": demo.coreDisplay,
                    "é¢„æœŸæ•ˆæžœ": demo.expectedEffect,
                    "èƒ½åŠ›åˆ†ç±»": ability.name
                }
            };

            try {
                await new Promise((resolve, reject) => {
                    const data = JSON.stringify(record);
                    const req = https.request({
                        hostname: 'open.feishu.cn',
                        path: `/open-apis/bitable/v1/apps/${feishuConfig.app_token}/tables/${DOUBAO_TABLE_ID}/records`,
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json',
                            'Content-Length': Buffer.byteLength(data)
                        }
                    }, res => {
                        let body = '';
                        res.on('data', chunk => body += chunk);
                        res.on('end', () => {
                            const result = JSON.parse(body);
                            result.code === 0 ? resolve(result) : reject(new Error(result.msg));
                        });
                    });
                    req.on('error', reject);
                    req.write(data);
                    req.end();
                });
                console.log(`[å†™å…¥ä¸­] ${demoIndex}/${totalDemos}: ${demo.name} âœ“`);
                successCount++;
            } catch (e) {
                console.log(`[å†™å…¥ä¸­] ${demoIndex}/${totalDemos}: ${demo.name} âœ— ${e.message}`);
                failCount++;
                failedRecords.push({ name: demo.name, error: e.message });
            }

            // é¿å…APIé™æµ
            await new Promise(r => setTimeout(r, 500));
        }
    }

    console.log('\n=== è±†åŒ…Demoç”Ÿæˆå®Œæˆ ===\n');
    console.log('è¾“å‡ºç»“æžœï¼š');
    console.log(`- JSONæ–‡ä»¶ï¼š${jsonPath}ï¼ˆ${totalDemos}ä¸ªDemoï¼‰`);
    console.log(`- é£žä¹¦å†™å…¥ï¼šæˆåŠŸ ${successCount} æ¡ï¼Œå¤±è´¥ ${failCount} æ¡`);

    if (failedRecords.length > 0) {
        console.log('\nå¤±è´¥è®°å½•ï¼š');
        failedRecords.forEach(r => console.log(`- ${r.name}: ${r.error}`));
    }

    console.log('\nä¸‹ä¸€æ­¥ï¼šè¿è¡Œ /score-doubao-demos ä¸ºæ‰€æœ‰Demoè¯„åˆ†');
}

writeToFeishu().catch(e => console.error('æ‰§è¡Œé”™è¯¯:', e.message));
